# 競プロ合宿の大体の流れ

## 基本
### この説明文について

**[2022/02/20 追記:]** [README.md](README.md) をご確認ください。

@Lapinpon が適当に書いたものです。質問とか疑問とか修正点とかあれば何個でも気軽にSlackでメンションを飛ばすか、issueを適当に立ててください。プルリク無言で飛ばすとかでもいいです。誤字修正程度でも普通に連絡ください。

また、いっぱい情報が書いてある気がしますが、正直大体ノリで理解されてる気はします。しかし、ノリで理解されていない部分などで他人と食い違いが生じたりしてびーとさんが激オコみたいな現場も何回か見たので一応こういうのを作っとこうと思いました。基本的にコマンドとかダルいとか、あんまモノを覚えたくないとかそういう人向けなので正規の方法ではないものが多いかもしれません。

そのうち、内容を分割してページをわけるかもしれません。

### 連絡手段
大体Slackです。何かあったらSlackに書いとけば返事がなくても誰かの脳裏に残ります。スタンプも来ないからってへこまず思った事は書くようにしましょう。荒らしたりしなければ多少変な事書いてもぶっちゃけ誰も気にしません。それより本番でミスがある方が何倍もまずかったりします。

しかし、事細かにリアルタイムなリスポンスが必要な作業がある場合もあります。そういう時もあるので部活で実際に顔を見せる必要が出てくるわけです。まあ、僕も含めてこない人はこないんですが。（来なさすぎると来まくってる人からのヘイトがたまるかもなので来てあげましょう。作問以外の部活の時は関係ないですけど。）

### 姿勢
ぶっちゃけ、一番裏であーだこーだしてるのは顧問だったり、RUPC2019はびーとさんが全部仕切ってたり、らしいです。びーとさんすごい。

言いたいのは全体を仕切ってる人の迷惑にならないような行動を心がけましょう、という事です。

### 各自の担当問題について
Google Driveの問題の様子の自分の問題の欄は基本的に担当者が更新します。（Google Driveのディレクトリ構成は少し下に書いてあります。）

例外は以下の2つです。
- テスターが解法を追加した際、自分の名前を入れて黄色にする
- 他者の問題のvalidatorを追加した際、自分の名前を入れて黄色にする

これら以外は基本、担当者が内容を変えます。

例えば、自分の問題で黄色くなっているテスターがいたらテストをして色を変えてあげます。テスターはそれを見てWAだったら作り直したり、ACしたら安心して寝たりします。ACが増えたら「担当者以外のAC数(judge待ち数)」欄も担当者が変えます。validatorも同様です。

HTMLとかレギュレーションが不明瞭な部分もあったりしますが、基本他人にチェックしてもらうみたいな動作を含むものはpushした後黄色を踏むと思ってもらって構わないです。というか、緑にしてしまっても部活への愛が強い人が勝手に見に来て文句を言ったりします。

とにかく、自分の問題の行の中身は基本的に自分で変更を加えるという事を忘れない様にしてください。

また、gitで自分がファイルを追加していいのはよくわからない場合、自分の問題内のファイル全て（他人が書いたvalidatorを除く）と他人の問題の自分が書くvalidator以外はいじらない事を念頭に置きましょう。ここら辺を超えて他人が編集する権限を持つファイルを編集してpushしてしまったりするとコンフリクトが起きる可能性がありますし、トラブルの元です。pushするファイルに何があるかよく見ておきましょう。

### その他
この文書内における「偉い部員」とは合宿進行や関係するソフトをよく知っている部員を指す言葉であり、実際に部員間に偉い偉くないとかはないです。（書き上げた後に直すのが面倒くさくなりました。）

ACPCはまだ自分たち側なので日程が掴みやすいですが、RUPCは向こうなので日程を掴みにくいです。現にRUPCの日程は大体3月後半に行われてきましたが、RUPC2019は3月頭に行われ結構混乱しました。余裕を持って準備をしましょう。

## Google Driveの共有ファイルの構成

- ACPC201〇
  - [部員の名前]
    - 問題文が書かれたドキュメント
  - 問題原案難易度表
  - 問題の様子
  - 名簿
  - 解説
    - A問題
    - B問題
    - C問題
    - ...

## 原案捻出期間（常に）
### そもそもどうやったら問題が浮かぶか
1. 適当にそこら辺の風景を眺める
2. 何か気づいて競プロ的問題との親和性を吟味する
3. 色々数値化できるところを数値化する
4. 問題完成！

（例）

何か、こたつがめがTLにいるな。
こたつがめって、コタツと亀の融合だな。
こたつって何か円っぽいな、周囲に効果がある何かの能力がありそう。
そういや、競プロには格子状の区画で色々動かす問題があったな。
周囲の区画の壁をこたつの赤外線とかで壊せる事にしよう。
でも、それだけだと器物損壊高橋君のパクリなんだよな。
爆弾を床に置いておいて、効果範囲に爆弾がある場合は能力を使えない様にしよう。
うむうむ、既出なのかよくわからんけどそれっぽいのが出来たぞ。

あとは何か凄い人だと既知のアルゴリズムだったり数学の何かを使ってそれを問題に転用する事ができるらしいですが、僕は水色なのでよくわかりません。そこら辺は橙コーダー先輩なり後輩なりに聞きましょう。

## 原案を出す
日頃考えていた問題を部活で指定された日までにGoogle Drive上の共有フォルダに出します。`ACPC201〇/[各自のID]/[Googleドキュメント]`みたいな感じで問題ファイルを作ります。締め切りは合宿の2か月前な事が多いです。ここでは、他の部員が自分の問題を見に来る事になるので、最終チェックレベルとは言いませんが支離滅裂な日本語とかsampleが0個とかそういうのはやめましょう。この時期にさっさとコードを書いてしまう甜菜テスターもいるらしいです。

原案を出したらGoogle Drive上の問題原案難易度表に問題を追加します。フォーマットは毎年不定っぽいですけど、大体難易度とタイトルと担当者名とドキュメントへのリンクが最低貼ってある気がします。

## 採用する問題の決定
少なくとも会津セットの場合は大体5時間なので10代前半ぐらい問題を採用する事になります。3時間セットとかの場合は7,8問でしょうか。今回は会津セットの場合で考えます。難易度順に問題が並んでる回に限ります。

部活ではよく先行してSlackに調整さんというのを貼り、重要な会議もどきの日程の調整みたいなのをします。これに行ける日とか行けない日とかポチポチチェックしておいて、後日決まった日に部活に行きます。採用する問題の決定もこんな感じで日付を決めておきます。本番日程すら調整くんが使われたりしますが、RUPCの本番は立命側が大体勝手に決めてます。

同じアルゴリズムが使われる問題が同時に採用される事は少ないです。

### A問題
A問題はAtCoder基準で100-200になりやすいです。虐殺系が時々入るらしいですが多分推奨されません。

### B-C問題
B-C問題はAtCoder基準で300-400になりやすいです。虐殺するO(1)問題や実装するだけ系、言語機能を活用する系が入ります。

### D-F問題
D-F問題はAtCoder基準で400-600になりやすいです。典型グラフアルゴリズムをいじった問題とかDPのちょっと考えるやつとか、ちょっとしたAd-hocが入りぎみです。また、会津セットの場合は誰かが幾何を用意しててここら辺に入れがちです。

### G-I問題
G-I問題はAtCoder基準で600-800になりやすいです。ここら辺はそういう問題が解ける人にコメントを書いて欲しいんですが、少なくとも最低限青レートぐらいは解くのに必要な気がします。（AtCoderの点数基準の説明みたいになってしまう）

### J-問題
J-問題はAtCoder基準で900-になりやすいです。何もわかりません。

## rimeを入れよう
競プロの問題のテストとかを管理するにあたり便利なソフトがあります。rimeがそうです、多分いろんなところで使われています。少なくともACPC、RUPCの会津セットでは毎回使われているので深刻なバグとかが出ない限り使われつづけるでしょう。

### rimeの入れ方
0. gitやpython3ぐらいは入れといてね。
1. https://github.com/icpc-jag/rime にいってgit cloneします。
2. 該当リポジトリで`python3 rime.py`とかすると何か出ると思います。
3. 各自aliasとかで`rime`で今のコマンドが実行される様にしておきます。
4. 導入完了！簡単だね！

これでrimeに対応したディレクトリ上でテストが実行できるようになります。rimeにはいろいろな機能があるらしいですが、とりあえずここでは必要最低限だけを書く事にします。

### rime testの仕方
- 問題のディレクトリに行って`rime test`と打つ。
- 問題のディレクトリの親ディレクトリで`rime test [問題のディレクトリ名]`と打つ。

どちらでもいいです、これも簡単だ！

## githubのレポジトリ内でのルール
こういうのはディレクトリを作る先輩が勝手にやってくれたりしますが、.gitignoreとかはちゃんと設定しましょう。rime-outとかをignoreしないと大変なことになります。といっても大体前年のコピペで済みます。

問題を分けるフォルダの名前は`E`とか`C`みたいなのは廃止され、問題名がそのまま使われることになっている気がします。そちらの方がわかりやすいですよね。以下よくある最小構成のディレクトリ構造です。rimeの機能を使って以下のファイルとかは自動生成できるらしいです。よくわからなくてコピペしまくっても何とかはなります。

- ACPC201〇
  - 問題名
    - PROBLEM (時間制限とか想定解とかの設定をrimeに伝えるファイルです)
    - [誰かの名前]
      - main.cpp (問題の解法ファイルです。)
      - SOLUTION (このディレクトリに解法があるよってのをrimeに伝えるファイルです。)
    - tests
      - 00_sample_01.in (sample1つ目)
      - 00_sample_02.in (sample2つ目)
      - generator.cpp (generator)
      - validator.cpp (自分が書いたvalidator)
      - validator_[誰かの名前].cpp (第三者が書いたvalidator)
      - TESTSET (generatorやvalidatorファイルのありかをrimeに伝えるファイルです)
      - testlib.h (最新版をコピペしましょう)
  - HTML
    - image
      - HTML内で使用する画像など
    - A.html
    - B.html
    - C.html
    - ...

### PROBLEM
合宿で使う程度なら意外と適当でいいらしいです。AtCoderとかでは結構ちゃんと書くらしいですけど、よく知りません。

- title

これは被らなければいいらしいので自分の名前とか書く人が多いです。

- id

これは被ってもいいらしいのでXとかYとかにしてます。（ポケモンか？）

- time_limit

結構重要で、これはTLEの時間設定です。とにかくぶん回したいときは114514.0とかにしといてもいいですが、ちゃんとtestする時は3sとか1sに設定しましょう。ここで設定した値がrime test時に各解法に適応されます。（つまり、この時間を超えて実行がされるとtestが落ちます）

push時にはGoogle Driveの問題の様子のTLEの部分と同じにする必要があります。

- reference_solution

想定解です。基本、作問者の名前が入ります。Google Driveの問題の様子の想定解コードと同じである必要があります。

### 解法フォルダ内
SOLUTION内部にC++の解法ならcxx_solution(src='main.cpp')みたいなのを足します。#行はコメントなので#を外して適当に穴埋めすればいいと思います。

#### 想定誤解法

想定誤解法みたいなのがあれば、解法ディレクトリの名前を`[自分の名前]_WA`とかにして中に解法を入れます。その際、SOLUTIONのcxx_solutionでは、`cxx_solution(src='[自分の名前]_WA', challenge_cases=[])`の様に`challenge_cases=[]`を追加します。これでrime test時に明示的にこの解法が落ちるという事をrimeに教えることが出来ます。

命名規則について、hoge_WAとかhoge_TLEとかhoge_bfとか、解法の種類みたいなのをわかりやすく書いたものが好まれます。hoge1、hoge2みたいに連番にすると本番直前で偉い部員さんがぶちぎれます。

#### C++以外の言語による解法
pythonならscript_solution(src='[自分の名前].py')とかに、javaならjava_solution...とかになると思います。使える言語は決まっていますがrimeのバージョンアップに従って徐々に増えていっているらしいです。

### tests内
これはgeneratorにも関わる話ですが.inファイルの命名規則を書きます。

### `AA_BB_CC_DD.in`
1. AAには2桁の数字が入ります。インプットの小さい順に処理がされると嬉しいため、小さいものから00,10,20...と辞書順になる様に名付けられます。
2. BBは自由です。人によって何も入れなかったり問題名を入れたりって感じですが長くなりすぎるとわかりにくいのでそこは気を付けましょう。
3. CCはsmallとかlargeとかインプットの内容をわかりやすく簡潔に説明する単語が入ります。
4. DDは上記1-3の同じくくりに入るインプットで順番に番号を振る為にあります。00_sample_01.in, 00_sample_02.in, 00_sample_03.in... といった感じです。

generator内のファイル名も同じように書いてください。細かくは後で説明します。

### sample inputの作り方
- 問題の特徴がわかりやすく感じ取れる小さいケースを作る
- 制約面で不安が起こるポイントなどを感じ取れるケースを作る
- outputが32bit整数に収まらない系があればそのケースを作る

もちろん、これらを全て搭載する必要はなく、ひっかけとして隠しておくのも大事です。大体サンプルの数は2-5個とかです。多すぎると、本番でページの一番下まで行ってsubmitするのがダルくなります。

### generatorやvalidatorらへんに共通する大事な話
当然なんですが、rime testでこれらが原因でバグった時に、コードが読みづらかったら最高に面倒です。特に、作問者本人がいない本番間近の部活でこれが起こると、デバッグをするのは第三者なのでクソほどムカつかれます。自信がなかったら本番前の部活はサボらない様にするか、完璧なものを仕上げておいて偉い部員の人に事前レビューぐらいしてもらう様にしましょう。これは問題文とか他のコードとか何にでも当てはまるかもしれません。

### generator
inputファイルをtest時に生成します。生成すると言っても実際にファイルがそのフォルダ内にできるわけではないのでtestを実行してファイルがないとか慌てない様にしましょう。

#### ファイル名
一つだけだったら`generator.cpp`ですが、複数ある場合は`generator_AA.cpp`みたいにして名前を分ける必要があります。連番とかにするとわかりにくいのでAAにはlargeとかsmallとか簡潔でわかりやすい単語を入れましょう。

#### 中身
他人のを基本的に見て書きましょう。サンプルを当リポジトリ内においておきますがポイントだけ押さえます。mainとstartに分かれているものが主流っぽいです。main内でケース分だけループを回しstartを実行する感じです。


- #include "testlib.h"

色んな関数が使えるようになるおまじないですね。

- #define CASE_NUM hoge

このgeneratorでhoge個ケースを作るよって意味です。大体main関数内のループで使われます。

- const int hoge_MAX = num;

hoge変数の上限を定数で書いておきます。これでこのケースがどれぐらいのサイズのインプットを扱ってるのか見やすくなります。MINも同様です。

- registerGen(argc, argv, 1);

main関数の先頭に書くおまじないです。

- ofstream out(format("AA_BB_CC_%02d.in", id).c_str());

ファイルに書き出す為のおまじないです。AAとかは上記の規則通りに書きましょう。

- rnd.nextとか

testlib.hの機能でランダム整数値を何かに代入するときによく使います。小数とか文字列とかもあった気がするんですがそれは各自。C++にあるrandom_deviceを使うと再現性がないとかで怒られます。

### validator
testsフォルダ内にあるgeneratorで作成したinputファイル、手書きinputファイルを制約を満たす内容であるかtest時にチェックします。

#### ファイル名
自分が作ったものは`validator.cpp`、他人の問題に自分のvalidatorを入れるときは`validator_[自分の名前].cpp`が基本の様です。

#### 中身
これも他人のを基本的に見て書きましょう。サンプルを当github内においておきますがポイントだけ押さえます。

- #include "testlib.h" や const int hoge_MAX = num;

generatorと同じくです。validatorなのでケースとかはありません。

- registerValidation();

mainの先頭に書くおまじない。

- inf.hogeみたいなの

  - inf.readIntは32bit整数を読み取ります。
  - inf.readSpaceは空白を読み取ります。
  - inf.readEolnは改行を読み取ります。
  - inf.readEofはEOFを読み取ります。
  - inf.readTokenみたいなのを使うと文字列を読み取れます。その他の使い方もあったかな。

最低限これらを知っていればvalidatorは書けるでしょう。

- デバッグについて

validatorを書いたはいいがtestでvalidatorチェックが通らず、しかしどこでエラーが出たのかわからないではあんまり意味がありません。inf何とか関数の最後の引数に追加でformat("hoge")みたいなのを書いておくとエラーが特定しやすくなります。

#### スペシャルジャッジについて
よく知らないので知ってる人おしえてください。

#### インタラクティブについて
よく知らないので知ってる人おしえてください。

### TESTSETについて
TESTSETにはtestに使うgeneratorやvalidatorなどのファイルを記述します。SOLUTIONと同じ感じで書けるでしょう。

## generator, validatorの作成
自分の担当の問題ができたら、generatorとvalidatorを作ります。質問があったら詳しい先輩に、詳しく知りたかったらtestlib.hとか他人が書いたコードを自分で読んでください。大体本番の1か月半前までには終わらせておきます。

出来次第、該当問題のgeneratorやvalidatorをoにしましょう。もちろん、各自テストを通した上です。

## 作問者以外のvalidator作成者決定
これも適当に部活で決まります。Google Driveの問題の様子に背景白で名前が追加されているので、該当の問題のvalidatorを`validator_[自分の名前].cpp`みたいな感じでpushして背景を黄色くします。該当の問題の担当者はそれをテストして緑にしたり赤にしたりします。赤だった場合はslackでメンションを飛ばすと優しいかもしれません。

作問者と第三者合計2人以上のvalidatorチェックは大体本番1か月前ぐらいに終わらせておきます。

## テスターを揃える
基本、各問題担当者とは別に3人のtestが通ったテスター解が必要です。該当問題にSOLUTIONファイルとmain.cppを追加したディレクトリをpushしてGoogle Driveの問題の様子のテスターに黄色背景で自分の名前を追加しておきます。自分の問題にテスターが来たらtestをして緑にしたり赤にしたりします。赤になった場合は解きなおすか闇に葬るかしましょう。

結構、毎年問題になっているのが後半の高難易度のテスターが集まらない事です。そしてテスター2人とか最悪1人とかで本番突入してたりします。しょうがないですね。（僕は解いたことがないです）

これは本番2週間前とかに終えときます。

## 本番用の問題文やhtmlを作成
きついやつです。自然言語と競プロの親和性は最悪なので、物語織り交ぜ系の問題を作る人は例外処理みたいなのに結構頭を悩ますかもしれません。その点、数式だけ書かれたような問題文だったら楽だったりしますが、そこはこだわりとかある人はあると思うので突っ込まないでおきます。

とにかく、問題文をじっくり読んだ時に未定義の処理みたいなものが発生しないか注意深く観察する事です。例えば、周囲8マスと言った時、盤面の端における周囲8マスが外になってしまって挙動が未定義、みたいな話です。そこらへんを注意して書きましょう。

### HTMLの書き方
当然ですが、自分の問題のhtmlを書きます。ACPC201〇直下のHTMLファイル内に[問題の添え字].htmlみたいな感じで保存します。

#### ヘッダー部分
コピペです。mathjaxとかそこら辺のやつです。

#### h1タグ
`Problem [添え字]: 問題名`とかです。問題名は英語でも日本語でも構いませんがページのタイトルは英語になります。

#### h2タグ
`Problem`とか`Input`とか書かれるやつです。これも大体お決まりです。

#### pタグ
段落ごとにpタグで文章をまとめます。問題文のpタグ内での改行は推奨されていません。が、inputでは改行は頻繁に使われます。imgタグもpタグで囲うといい感じに上下に空白ができます。

#### TeXについて
$で囲んだ部分でTeXが使えます。空白は`\ `を使わない文化があるらしいですがよくわかりません。点々とかは\vdots,\cdotsとかを使いましょう。ここら辺はTeXの話なので割愛。

#### 制約
ulタグとliタグが使われます。つまり、箇条書きで制約が書かれるという事です。

#### sample
preタグで囲んで入力や出力を記述します。


本番1週間前には完成されているべきですが毎回守らていません。

## テストデータ作成
これ実はよく知りません、RUPC2019はびーとさんが勝手にやってました。びーとさん教えてください。

## いろいろ最終チェック
### 問題文
上記のきついやつをみんなでやるやつです。正直、準備で一番大変です。来てない人の問題について問題があると怒号が飛び交います。作問者は来なさい。

### sample inputがちゃんとあるか
各問題のディレクトリを見に行って確認します。

### HTML内のsampleが正しいかを確認
HTMLファイルを見に行きます。rime-out内のsampleファイルとかを見て合ってるか確認します。

### AOJテスト
AOJでrime test時に使われた解法を投げてACがACに、WAがWAに、TLEがTLEになるか確認します。

### テストケースの強さチェック
generatorが一番きつい制約のinputを吐き出すか確認します。大体、N_MAXみたいな値がちゃんと設定されて使われているかみるだけで終わります。あと、generatorが正しくTESTSET内で記述されているか確認します。

### validatorチェック
validatorが正しいかを見ます。制約の値とMAX,MINの値が同じとかそういうやつです。

これらは直前1週間から前々日ぐらいまでにかけてやられます。

## たぶん、これで本番です
ほんまか？問題に対して愛がある人は直前までチェックしてミスがないか確認したりしてるらしいです。あとはジャッジを眺めて楽しみましょう。クラーも見る。お菓子も食べる。

### 解説を書く
担当した問題の解説を書きましょう。これも大体のフォーマットが決まっています。問題の重さに応じて内容を臨機応変に変えましょう。例えば、簡単な問題ならみんなが解けていると思うので、サクサク解説が進むような構成にした方がいいです。かと、言って難しすぎる問題で冗長にしてもみんな寝るので細かい情報を書くだけ書いといて後で気になる人は公開した時に各自読んでとかでもいいかもしれません。

#### 1ページ目、タイトル
ACPC201〇Day2、問題名、原案とか担当とかです。

#### 概要
問題の概要を書きます。簡単な問題程流す程度でいいところです。

#### 方針とか嘘解法とか考察とか
問題を解くにあたっての思考経路みたいなのを書きます。

#### 解法
想定解が何であるかを書きます。複数ある場合は複数書きましょう。

#### 統計
FAとかSuccess Rateとか、おきまり。

#### ジャッジ解
テスターと自分のコードの情報を載せます。

### その他、解説について
総評とかは何か偉い部員さんに別途書いてとか言われるので指示に従いましょう。
